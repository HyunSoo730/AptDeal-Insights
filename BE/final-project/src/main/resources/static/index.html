<!--<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vite App</title>
    <script type="module" crossorigin src="/assets/index-a5_eX9It.js"></script>
  </head>
  <body>
    <div id="app"></div>

  </body>
</html>-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>아파트 매매 정보 마커 표시</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div id="map" style="width:100%;height:350px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=695b0f25ff6a1cf8784717f602a2d1f4"></script>
<script>
  var mapContainer = document.getElementById('map'),
      mapOption = {
          center: new kakao.maps.LatLng(37.5665, 126.9780),
          level: 3
      };

  var map = new kakao.maps.Map(mapContainer, mapOption);

  // 서버로부터 아파트 매매 정보를 받아와 마커를 표시합니다.
  $.getJSON("/apt-sales", function(data) {
    var positions = [];
    for (var i = 0; i < data.length; i++) {
      var aptSale = data[i];
      positions.push({
        content: '<div>' + aptSale.aptName + '</div>',
        latlng: new kakao.maps.LatLng(aptSale.latitude, aptSale.longitude)
      });
    }

    for (var i = 0; i < positions.length; i++) {
      var marker = new kakao.maps.Marker({
        map: map,
        position: positions[i].latlng
      });

      var infowindow = new kakao.maps.InfoWindow({
        content: positions[i].content
      });

      kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
      kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
    }
  });

  function makeOverListener(map, marker, infowindow) {
    return function() {
      infowindow.open(map, marker);
    };
  }

  function makeOutListener(infowindow) {
    return function() {
      infowindow.close();
    };
  }
</script>
</body>
</html>